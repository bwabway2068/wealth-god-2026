<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>太乙救苦天尊｜解業消災祈福法會</title>
    <!-- 1. 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dao-black': '#050a08',
                        'dao-dark': '#0a1410',
                        'dao-gold': '#d4af37',
                        'dao-gold-light': '#fcf6ba',
                        'dao-green': '#064e3b',
                        'dao-jade': '#10b981',
                        stone: { 800: '#1c1917', 900: '#0c0a09', 950: '#050a08' },
                    },
                    fontFamily: {
                        'serif': ['"Noto Serif TC"', 'serif'],
                        'sans': ['"Noto Sans TC"', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.8s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <!-- 2. 載入 React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- 3. 載入 Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 4. Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Noto+Sans+TC:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        body { background-color: #050a08; color: #e5e7eb; font-family: 'Noto Sans TC', sans-serif; }
        .serif-font { font-family: 'Noto Serif TC', serif; }
        
        /* 捲動條樣式 */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(6, 78, 59, 0.1); border-radius: 8px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(212, 175, 55, 0.5); border-radius: 8px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(212, 175, 55, 0.8); }
        
        /* 日期輸入框深色模式與白色圖示 */
        input[type="date"] { 
            color-scheme: dark; 
        }
        input[type="date"]::-webkit-calendar-picker-indicator { 
            cursor: pointer; 
            opacity: 1; 
            /* filter: invert(1); <--- 移除這行，因為 color-scheme: dark 已經會提供白色圖示 */
        }
        
        /* 金色文字漸層 */
        .gold-text {
            background: linear-gradient(to bottom, #fcf6ba, #d4af37, #aa771c);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- SVG 圖示組件 ---
        const Icons = {
            Lotus: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3c-4 4-6 9-6 13 0 2.5 2 5 6 5s6-2.5 6-5c0-4-2-9-6-13z"/><path d="M12 21a9 9 0 0 1-9-9c0-3 2-6 5-8"/><path d="M12 21a9 9 0 0 0 9-9c0-3-2-6-5-8"/><path d="M12 16a4 4 0 0 0 0-8 4 4 0 0 0 0 8z"/></svg>,
            CheckCircle: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            ArrowRight: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>,
            CalendarDays: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></svg>,
            ScrollText: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 12h-5"/><path d="M15 8h-5"/><path d="M19 17V5a2 2 0 0 0-2-2H4"/><path d="M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"/></svg>,
            Users: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Leaf: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.77 10-10 10Z"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></svg>,
            ExternalLink: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>,
            MessageCircle: ({size=24, className}) => <svg width={size} height={size} className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/></svg>
        };

        // --- 2026 丙午年 日程表 ---
        const baseSchedule = [
          { month: '正月', d1: '', d15: '2026-03-03' },
          { month: '二月', d1: '2026-03-19', d15: '2026-04-02' },
          { month: '三月', d1: '2026-04-17', d15: '2026-05-01' },
          { month: '四月', d1: '2026-05-17', d15: '2026-05-31' },
          { month: '五月', d1: '2026-06-15', d15: '2026-06-29' },
          { month: '六月', d1: '2026-07-15', d15: '2026-07-29' },
          { month: '七月', d1: '2026-08-13', d15: '2026-08-27' },
          { month: '八月', d1: '2026-09-11', d15: '2026-09-25' },
          { month: '九月', d1: '2026-10-10', d15: '2026-10-24' }, 
          { month: '十月', d1: '2026-11-09', d15: '2026-11-23' },
          { month: '十一月', d1: '2026-12-09', d15: '2026-12-23' },
          { month: '十二月', d1: '2027-01-08', d15: '2027-01-22' },
        ];

        const lunarMonthMap = { '正月': 1, '二月': 2, '三月': 3, '四月': 4, '五月': 5, '六月': 6, '七月': 7, '八月': 8, '九月': 9, '十月': 10, '十一月': 11, '十二月': 12 };

        // 自動推算農曆是否需順延 (含戊日、受死日等)
        const getAdjustedDate = (dateString, lunarMonthName) => {
          if (!dateString) return null;
          // 特殊日期規則
          const specialDateRules = {
            '2026-03-19': { forceDelay: true, reason: '受死' },
            '2026-05-01': { forceDelay: true, reason: '受死' },
            '2026-05-31': { forceDelay: true, reason: '受死' },
            '2026-06-29': { forceNoDelay: true },
            '2026-07-29': { forceNoDelay: true },
            '2026-08-13': { forceNoDelay: true },
            '2026-09-11': { forceDelay: true, reason: '戊日' }, 
            '2026-11-09': { forceNoDelay: true },
            '2027-01-22': { forceDelay: true, reason: '紅紗' }, 
          };

          let date = new Date(dateString);
          let isDelayed = false;
          let delayReason = '';

          if (specialDateRules[dateString]) {
            const rule = specialDateRules[dateString];
            if (rule.forceNoDelay) {
               // 不需順延
            } else if (rule.forceDelay) {
              date.setDate(date.getDate() + 1);
              isDelayed = true;
              delayReason = rule.reason;
            }
          } else {
             const lunarMonth = lunarMonthMap[lunarMonthName] || 1; 
             const baseDate = new Date('2026-01-01');
             const timeDiff = date.getTime() - baseDate.getTime();
             const dayDiff = Math.floor(timeDiff / (1000 * 3600 * 24)); 
             let stemIndex = (5 + dayDiff) % 10;
             // 簡單判斷戊日
             if (stemIndex === 4) { isDelayed = true; delayReason = '戊日'; date.setDate(date.getDate() + 1); }
          }
          
          const y = date.getFullYear();
          const m = String(date.getMonth() + 1).padStart(2, '0');
          const d = String(date.getDate()).padStart(2, '0');
          return { original: dateString, actual: `${y}-${m}-${d}`, isDelayed, delayReason };
        };

        const planOptions = [ "【太乙救苦天尊】解業消災法會 - NT$ 850" ];

        function App() {
          const [schedule, setSchedule] = useState([]);
          const [isSubmitting, setIsSubmitting] = useState(false);
          const [isSubmitted, setIsSubmitted] = useState(false);
          
          // 截止日期設定 (法會前5天截止)
          const cutoffDate = new Date();
          cutoffDate.setDate(cutoffDate.getDate() + 5); 
          const cutoffDateString = `${cutoffDate.getFullYear()}-${String(cutoffDate.getMonth() + 1).padStart(2, '0')}-${String(cutoffDate.getDate()).padStart(2, '0')}`;

          const [formData, setFormData] = useState({
            name: '', phone: '', address: '', 
            calendarType: '農曆', birthDate: '', birthTime: '吉時',
            selectedDates: [],
            sessionType: planOptions[0],
            participantsCount: 1,
            additionalInfo: ''
          });

          useEffect(() => {
            const processedSchedule = baseSchedule.map(item => ({
              month: item.month,
              d1: getAdjustedDate(item.d1, item.month),
              d15: getAdjustedDate(item.d15, item.month)
            }));
            setSchedule(processedSchedule);
          }, []);

          const handleInputChange = (e) => {
            const { name, value } = e.target;
            setFormData(prev => ({ 
              ...prev, 
              [name]: name === 'participantsCount' ? parseInt(value, 10) || 1 : value 
            }));
          };

          const toggleDate = (dateActual) => {
            setFormData(prev => {
              const isSelected = prev.selectedDates.includes(dateActual);
              if (isSelected) return { ...prev, selectedDates: prev.selectedDates.filter(d => d !== dateActual) };
              else return { ...prev, selectedDates: [...prev.selectedDates, dateActual] };
            });
          };

          const handleReset = () => {
            setIsSubmitted(false);
            setFormData({
              name: '', phone: '', address: '', 
              calendarType: '農曆', birthDate: '', birthTime: '吉時',
              selectedDates: [],
              sessionType: planOptions[0],
              participantsCount: 1,
              additionalInfo: ''
            });
            document.getElementById('register').scrollIntoView({ behavior: 'smooth' });
          };

          const handleSubmit = async (e) => {
            e.preventDefault();
            if (formData.selectedDates.length === 0) { alert("請至少選擇一個法會日期！"); return; }
            setIsSubmitting(true);
            
            // ⚠️ 請在此處填入您的 Google Web App URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwVkfcWX_S2jjNnUmodEyH-0mzraRMFijaY-bfriRQf7OrGSR2KYtOZcxH7DRqK7K0h/exec'; 
            
            const calculatedTotal = 850 * parseInt(formData.participantsCount || 1, 10) * formData.selectedDates.length;

            // 準備傳送給後台的資料格式
            const payload = {
              ...formData,
              selectedDate: formData.selectedDates.join('、 '),
              additionalInfo: formData.additionalInfo ? formData.additionalInfo : '無',
              totalPrice: calculatedTotal,
              formSource: '太乙救苦天尊解業科儀',
              ritualType: '解業'
            };

            console.log("【資料送出檢查】", payload);

            try {
              // 若未填入 URL，僅做模擬
              if (GOOGLE_SCRIPT_URL === '請替換成您的_Google_Script_網址') {
                  console.warn("尚未設定 Google Script URL，執行模擬送出");
                  setTimeout(() => {
                      setIsSubmitted(true);
                      document.getElementById('register').scrollIntoView({ behavior: 'smooth' });
                      setIsSubmitting(false);
                  }, 1500);
                  return;
              }

              const response = await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                body: JSON.stringify(payload),
              });
              
              if (response.ok) {
                setIsSubmitted(true);
                document.getElementById('register').scrollIntoView({ behavior: 'smooth' });
              } else {
                alert("送出失敗，請稍後再試或聯繫客服。");
              }
            } catch (error) {
              console.error("提交錯誤:", error);
              alert("網路連線異常，請確認網路狀態後再試。");
            } finally {
              setIsSubmitting(false);
            }
          };

          const totalPrice = 850 * parseInt(formData.participantsCount || 1, 10) * formData.selectedDates.length;

          return (
            <div className="relative min-h-screen text-gray-300 font-sans selection:bg-dao-green selection:text-white overflow-hidden bg-dao-black">
              
              {/* 背景層 */}
              <div className="fixed inset-0 z-[-2] bg-dao-black"></div>
              <div className="fixed top-[-20%] left-[-10%] w-[60vw] h-[60vw] bg-dao-green/20 blur-[120px] rounded-full pointer-events-none"></div>
              <div className="fixed bottom-[-20%] right-[-10%] w-[60vw] h-[60vw] bg-dao-gold/10 blur-[120px] rounded-full pointer-events-none"></div>

              {/* 1. 主視覺 Header */}
              <header className="relative py-28 px-4 sm:px-8 overflow-hidden min-h-[90vh] flex items-center justify-center border-b border-dao-green/30">
                <div className="absolute inset-0 z-0">
                    <img src="https://images.unsplash.com/photo-1517462180436-e63b65275e07?q=80&w=2000&auto=format&fit=crop" className="w-full h-full object-cover opacity-30" alt="禪意背景" />
                    <div className="absolute inset-0 bg-gradient-to-b from-dao-black/70 via-dao-black/50 to-dao-black"></div>
                </div>

                <div className="max-w-4xl mx-auto relative z-10 text-center space-y-8 mt-10">
                  <div className="inline-block px-6 py-2 rounded-full border border-dao-gold/50 bg-dao-black/50 backdrop-blur-md text-dao-gold font-bold tracking-[0.3em] text-sm mb-2 shadow-lg animate-pulse-slow">
                    尋聲救苦 · 慈悲濟世
                  </div>
                  <h1 className="text-5xl md:text-7xl font-bold serif-font leading-tight drop-shadow-[0_5px_5px_rgba(0,0,0,0.8)]">
                    <span className="gold-text block mb-2">太乙救苦天尊</span>
                    <span className="text-white text-3xl md:text-5xl font-light tracking-wide">解業消災祈福法會</span>
                  </h1>
                  <p className="text-xl md:text-2xl text-gray-300 max-w-2xl mx-auto leading-relaxed font-light mt-6">
                    至心歸命禮，東極妙嚴宮。<br/>
                    <span className="text-dao-jade font-medium">化解累世冤親，洗淨今生業障。</span><br/>
                    祈求身心安泰，福慧雙修。
                  </p>
                  
                  <div className="pt-8 flex flex-col sm:flex-row gap-4 justify-center items-center">
                    <a href="#register" className="inline-flex items-center gap-2 bg-gradient-to-r from-dao-green to-emerald-800 text-white font-bold text-xl px-10 py-5 rounded-sm shadow-[0_0_30px_rgba(16,185,129,0.3)] hover:shadow-[0_0_40px_rgba(16,185,129,0.5)] transition-all hover:-translate-y-1">
                      預約太乙解業 <Icons.ArrowRight size={24} />
                    </a>
                    <a href="https://portaly.cc/bwa.bway2068" target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-2 border border-dao-gold text-dao-gold hover:bg-dao-gold/10 font-bold text-xl px-10 py-5 rounded-sm transition-all">
                      報名其他科儀 <Icons.ScrollText size={24} />
                    </a>
                  </div>
                </div>
              </header>

              {/* 2. 介紹與適用對象 */}
              <section id="intro" className="py-20 px-4 max-w-5xl mx-auto">
                <div className="text-center mb-16">
                  <h2 className="text-3xl font-bold text-dao-gold serif-font mb-4 flex items-center justify-center gap-2">
                    <Icons.Lotus className="text-dao-jade" /> 為何需要做解業？
                  </h2>
                  <div className="h-1 w-24 bg-dao-green mx-auto rounded"></div>
                </div>
                
                <div className="grid md:grid-cols-2 gap-12 items-center">
                  <div className="space-y-6 text-lg leading-relaxed text-justify">
                    <p>
                        「業」是我們過去的行為所留下的影響。當運勢受阻、身體莫名病痛、或人際關係不順時，往往是累世或今生的<strong className="text-white">「冤結」未解</strong>。
                    </p>
                    <div className="bg-dao-green/10 border-l-4 border-dao-gold p-6 rounded-r-lg relative">
                      <p className="text-gray-200 relative z-10 italic">
                        「解業科儀並非迷信，而是一場莊嚴的懺悔與和解儀式。透過太乙天尊的慈悲願力，調解陰陽兩界的糾葛，將冤親債主化為善緣。」
                      </p>
                    </div>
                    <p>
                        太乙救苦天尊，九色蓮花座下，九頭獅子吼聲震開地獄之門。祂不僅救度亡魂，更能為在世之人<strong className="text-dao-jade">化解冤結、消除業障、治癒身心疾苦</strong>。
                    </p>
                  </div>
                  
                  <div className="bg-dao-dark/80 backdrop-blur-md border border-dao-green/30 p-8 rounded-2xl shadow-2xl relative">
                    <h3 className="text-xl font-bold text-white mb-6 border-b border-dao-green/30 pb-4 serif-font">誰需要參加解業法會？</h3>
                    <ul className="space-y-5">
                      <li className="flex gap-4 items-start">
                        <div className="text-dao-gold shrink-0 mt-1"><Icons.CheckCircle size={20} /></div>
                        <div>
                          <strong className="text-dao-jade block mb-1">流年不利者</strong>
                          <p className="text-sm text-gray-400">運勢低迷，做什麼事都差臨門一腳，常遇小人阻礙。</p>
                        </div>
                      </li>
                      <li className="flex gap-4 items-start">
                        <div className="text-dao-gold shrink-0 mt-1"><Icons.CheckCircle size={20} /></div>
                        <div>
                          <strong className="text-dao-jade block mb-1">身體微恙者</strong>
                          <p className="text-sm text-gray-400">雖無大病但小病不斷，精神萎靡，夜夢不安，睡眠品質差。</p>
                        </div>
                      </li>
                      <li className="flex gap-4 items-start">
                        <div className="text-dao-gold shrink-0 mt-1"><Icons.CheckCircle size={20} /></div>
                        <div>
                          <strong className="text-dao-jade block mb-1">家庭不睦者</strong>
                          <p className="text-sm text-gray-400">家宅氣場紛亂，爭吵不斷，六親緣薄，欲改善關係者。</p>
                        </div>
                      </li>
                      <li className="flex gap-4 items-start">
                        <div className="text-dao-gold shrink-0 mt-1"><Icons.CheckCircle size={20} /></div>
                        <div>
                          <strong className="text-dao-jade block mb-1">欲解冤親者</strong>
                          <p className="text-sm text-gray-400">自覺有虧欠前世今生，欲做功德迴向冤親債主。</p>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </section>
              
              {/* Promotional Images Section */}
              <section className="py-8 px-4 max-w-5xl mx-auto space-y-8">
                {/* 1200x450 Ad Banner */}
                <div className="relative w-full rounded-xl overflow-hidden shadow-[0_0_30px_rgba(6,78,59,0.3)] border border-dao-gold/30 group">
                  <img 
                    src="https://bwabway2068.github.io/wealth-god-2026/banner4.jpg" 
                    alt="太乙救苦天尊宣傳橫幅" 
                    className="w-full aspect-[1200/450] object-cover opacity-90 group-hover:opacity-100 transition-all duration-700 transform group-hover:scale-105"
                  />
                </div>

                {/* 1376x768 Detail Image */}
                <div className="relative w-full rounded-xl overflow-hidden shadow-[0_0_30px_rgba(6,78,59,0.3)] border border-dao-gold/30 group">
                  <img 
                    src="https://bwabway2068.github.io/wealth-god-2026/banner3.jpg" 
                    alt="詳細說明圖" 
                    className="w-full aspect-[1376/768] object-cover opacity-90 group-hover:opacity-100 transition-all duration-700 transform group-hover:scale-105"
                  />
                </div>
              </section>

              {/* 3. 方案價格 */}
              <section className="py-20 bg-dao-green/5 border-t border-dao-green/20 relative">
                <div className="max-w-4xl mx-auto px-4">
                  <div className="text-center mb-12">
                     <h2 className="text-3xl font-bold serif-font gold-text">科儀結緣方案</h2>
                  </div>

                  <div className="bg-gradient-to-br from-dao-dark to-black border border-dao-gold/30 p-8 sm:p-12 rounded-lg shadow-[0_0_50px_rgba(6,78,59,0.3)] flex flex-col md:flex-row items-center justify-between gap-8 relative overflow-hidden group hover:border-dao-gold transition-colors">
                    <div className="absolute top-0 right-0 w-64 h-64 bg-dao-jade/10 blur-[80px] rounded-full pointer-events-none"></div>

                    <div className="flex-1 space-y-4 text-center md:text-left relative z-10">
                      <h3 className="text-2xl font-bold text-white flex items-center justify-center md:justify-start gap-2 serif-font">
                        <Icons.Leaf className="text-dao-jade" size={24} /> 個人解業消災疏文
                      </h3>
                      <p className="text-gray-400 text-sm md:text-base leading-relaxed">
                        包含：法師親批疏文、太乙解厄神咒加持、<br/>
                        化解冤結金紙一份、祈福平安米。
                      </p>
                      <div className="inline-block bg-dao-green/20 text-dao-jade text-sm px-4 py-2 rounded border border-dao-green/50 mt-2">
                        🌿 結緣禮：百解符 + 藥王除障願香 10ml
                      </div>
                    </div>

                    <div className="text-center md:text-right shrink-0 relative z-10">
                      <div className="text-4xl font-black text-dao-gold mb-4 serif-font">NT$ 850</div>
                      <a href="#register" className="inline-block bg-dao-gold hover:bg-yellow-600 text-black font-bold px-10 py-3 rounded-sm transition-all transform hover:scale-105 shadow-lg">
                        立即登記
                      </a>
                    </div>
                  </div>
                </div>
              </section>

              {/* 4. 日程表 */}
              <section className="py-16 px-4 max-w-4xl mx-auto">
                <div className="text-center mb-10">
                  <h2 className="text-3xl font-bold text-dao-gold serif-font flex items-center justify-center gap-2 mb-4">
                    <Icons.CalendarDays /> 2026 解業科儀日程
                  </h2>
                  <p className="text-gray-500 text-sm">逢「戊日」或「受死日」「月破日」「紅砂日」順延舉辦，以確保科儀圓滿。</p>
                </div>

                <div className="overflow-x-auto bg-dao-dark/80 backdrop-blur-md rounded-lg border border-dao-green/30 shadow-xl">
                  <table className="w-full text-left text-sm md:text-base">
                    <thead className="bg-dao-black/80 text-dao-gold border-b border-dao-green/30">
                      <tr>
                        <th className="p-4 font-bold text-center">月份</th>
                        <th className="p-4 font-bold">初一 科儀日</th>
                        <th className="p-4 font-bold">十五 科儀日</th>
                      </tr>
                    </thead>
                    <tbody className="divide-y divide-dao-green/10">
                      {schedule.map((item, index) => (
                        <tr key={index} className="hover:bg-dao-green/5 transition-colors">
                          <td className="p-4 font-bold text-center text-dao-jade serif-font">{item.month}</td>
                          <td className="p-4">
                            {item.d1 ? (
                              item.d1.isDelayed ? (
                                <div className="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2">
                                  <span className="line-through text-gray-600 text-xs">{item.d1.original}</span>
                                  <span className="text-white">{item.d1.actual}</span>
                                  <span className="text-[10px] bg-red-900/50 text-red-200 px-1.5 rounded border border-red-800">{item.d1.delayReason}順延</span>
                                </div>
                              ) : <span className="text-gray-300">{item.d1.actual}</span>
                            ) : <span className="text-gray-600 text-xs">暫停</span>}
                          </td>
                          <td className="p-4">
                            {item.d15 ? (
                              item.d15.isDelayed ? (
                                <div className="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2">
                                  <span className="line-through text-gray-600 text-xs">{item.d15.original}</span>
                                  <span className="text-white">{item.d15.actual}</span>
                                  <span className="text-[10px] bg-red-900/50 text-red-200 px-1.5 rounded border border-red-800">{item.d15.delayReason}順延</span>
                                </div>
                              ) : <span className="text-gray-300">{item.d15.actual}</span>
                            ) : <span className="text-gray-600 text-xs">暫停</span>}
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </section>

              {/* 5. 信眾回饋 */}
              <section className="py-20 bg-dao-green/5 backdrop-blur-sm px-4">
                <div className="max-w-6xl mx-auto space-y-12">
                  <div className="text-center space-y-4">
                    <h2 className="text-3xl font-bold serif-font text-dao-gold mb-2">信眾感應回饋</h2>
                    <p className="text-gray-400">心誠則靈，解開結，路就通了。</p>
                  </div>

                  <div className="grid md:grid-cols-3 gap-6">
                    <div className="bg-dao-dark p-6 rounded-lg border border-dao-green/20 hover:border-dao-gold/50 transition-colors">
                      <p className="text-gray-300 text-sm leading-relaxed mb-6 italic">
                        「這兩年運勢一直很卡，工作不順，身體也總是這裡痛那裡痛。參加了解業科儀後，感覺肩膀上的重擔突然輕了很多，睡眠品質改善非常多，真的很神奇。」
                      </p>
                      <div className="flex items-center gap-3 border-t border-dao-green/20 pt-4">
                        <div className="w-10 h-10 rounded-full bg-dao-green/30 flex items-center justify-center text-dao-jade font-bold">陳</div>
                        <div><div className="text-white text-sm">陳小姐</div><div className="text-gray-500 text-xs">行政人員</div></div>
                      </div>
                    </div>
                    
                    <div className="bg-dao-dark p-6 rounded-lg border border-dao-green/20 hover:border-dao-gold/50 transition-colors">
                      <p className="text-gray-300 text-sm leading-relaxed mb-6 italic">
                        「以前家裡常因為小事吵架，氣氛很僵。幫全家人報名解冤釋結後，感覺家裡的戾氣少了很多，大家說話也比較心平氣和了，感謝天尊保佑。」
                      </p>
                      <div className="flex items-center gap-3 border-t border-dao-green/20 pt-4">
                        <div className="w-10 h-10 rounded-full bg-dao-gold/20 flex items-center justify-center text-dao-gold font-bold">林</div>
                        <div><div className="text-white text-sm">林先生</div><div className="text-gray-500 text-xs">自營商</div></div>
                      </div>
                    </div>

                    <div className="bg-dao-dark p-6 rounded-lg border border-dao-green/20 hover:border-dao-gold/50 transition-colors">
                      <p className="text-gray-300 text-sm leading-relaxed mb-6 italic">
                        「雖然沒有大病，但精神一直很差。第一次參加科儀，聽到法師誦經時忍不住一直流淚，法會結束後卻覺得無比輕鬆，像是把心裡的垃圾都倒乾淨了。」
                      </p>
                      <div className="flex items-center gap-3 border-t border-dao-green/20 pt-4">
                        <div className="w-10 h-10 rounded-full bg-dao-jade/20 flex items-center justify-center text-dao-jade font-bold">張</div>
                        <div><div className="text-white text-sm">張小姐</div><div className="text-gray-500 text-xs">家庭主婦</div></div>
                      </div>
                    </div>
                  </div>
                </div>
              </section>

              {/* 6. 報名表單 */}
              <section id="register" className="py-20 px-4 max-w-3xl mx-auto">
                <div className="bg-dao-dark border border-dao-gold/50 rounded-lg p-8 md:p-12 shadow-[0_0_40px_rgba(6,78,59,0.2)]">
                  
                  {isSubmitted ? (
                    // 感謝頁面內容
                    <div className="text-center py-10 space-y-6 animate-fade-in max-w-lg mx-auto">
                      <div className="mx-auto w-24 h-24 bg-dao-gold/10 rounded-full flex items-center justify-center text-dao-gold border border-dao-gold mb-6">
                        <Icons.Leaf size={48} />
                      </div>
                      <h2 className="text-3xl md:text-4xl font-bold text-white mb-2 serif-font">功德圓滿</h2>
                      <h3 className="text-xl md:text-2xl font-bold text-dao-gold mb-6">感謝您的報名，疏文已受理</h3>
                      
                      <div className="bg-dao-green/10 border border-dao-green/30 p-6 rounded-lg text-left relative overflow-hidden mb-8">
                         <div className="space-y-4 font-mono text-lg">
                            <div className="flex justify-between border-b border-gray-700 pb-2">
                                <span className="text-gray-400 text-sm font-sans">銀行代碼</span>
                                <span className="text-white">013 (國泰世華)</span>
                            </div>
                            <div className="flex justify-between border-b border-gray-700 pb-2">
                                <span className="text-gray-400 text-sm font-sans">匯款帳號</span>
                                <span className="text-dao-gold text-2xl font-bold tracking-widest">059506013547</span>
                            </div>
                            <div className="flex justify-between pt-2">
                                <span className="text-gray-400 text-sm font-sans">結緣金額</span>
                                <span className="text-dao-gold text-2xl font-bold">NT$ {totalPrice.toLocaleString()}</span>
                            </div>
                         </div>
                      </div>
                      
                      <p className="text-gray-400 text-sm mb-6">
                        請於三日內完成匯款，並加入官方 LINE 告知末五碼以利核對。
                      </p>

                      <div className="flex flex-col gap-4">
                        <a href="https://line.me/ti/p/~@995zkady#~" target="_blank" rel="noopener noreferrer" className="w-full bg-gradient-to-r from-dao-green to-emerald-800 hover:from-emerald-700 hover:to-emerald-900 text-white font-bold py-4 rounded transition-colors flex items-center justify-center gap-2 shadow-lg">
                            <Icons.MessageCircle size={20} />
                            前往 LINE@ 回報匯款資訊
                        </a>
                        <button onClick={handleReset} className="w-full bg-transparent border border-dao-gold text-dao-gold hover:bg-dao-gold hover:text-black font-bold py-4 rounded transition-colors">
                            返回報名頁
                        </button>
                        <a href="https://portaly.cc/bwa.bway2068" target="_blank" rel="noopener noreferrer" className="w-full bg-dao-gold/10 border border-dao-gold text-dao-gold hover:bg-dao-gold hover:text-black font-bold py-4 rounded transition-colors flex items-center justify-center gap-2">
                            <Icons.ExternalLink size={20} />
                            瀏覽其他科儀
                        </a>
                      </div>
                    </div>
                  ) : (
                    // 填寫表單內容
                    <>
                      <div className="text-center mb-10">
                        <h2 className="text-3xl font-bold serif-font gold-text mb-2">線上報名疏文</h2>
                        <p className="text-gray-400 text-sm">請詳細填寫資料，法師將於法會當日為您呈疏化寶</p>
                      </div>

                      <form onSubmit={handleSubmit} className="space-y-6">
                        
                        {/* 份數選擇 */}
                        <div className="bg-dao-green/5 p-6 rounded border border-dao-green/20">
                          <label className="block text-sm font-medium text-dao-gold mb-2 flex items-center gap-2">
                            <Icons.Users size={18} /> 報名份數
                          </label>
                          <select name="participantsCount" value={formData.participantsCount} onChange={handleInputChange}
                            className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold text-lg">
                            {[...Array(10)].map((_, i) => <option key={i+1} value={i+1}>{i+1} 份</option>)}
                          </select>
                          
                          {formData.participantsCount > 1 && (
                            <div className="mt-4 pt-4 border-t border-gray-700 space-y-3 animate-fade-in">
                              <label className="block text-sm font-medium text-dao-gold">其他祈福者資料</label>
                              <p className="text-xs text-gray-400">請填寫所有參與者的：姓名 / 請註明國曆(農曆)生日 / 地址</p>
                              <textarea name="additionalInfo" rows="4" value={formData.additionalInfo} onChange={handleInputChange}
                                className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold resize-none"
                                placeholder="例：&#10;1. 王大明 / 65年8月15日 / 台北市...&#10;2. 李小美 / 68年2月2日 / 台北市..."></textarea>
                            </div>
                          )}
                        </div>

                        {/* 基本資料 */}
                        <div className="grid md:grid-cols-2 gap-6">
                          <div>
                            <label className="block text-sm font-medium text-gray-300 mb-1">祈福人姓名 *</label>
                            <input type="text" name="name" required value={formData.name} onChange={handleInputChange}
                              className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold" placeholder="請填寫姓名" />
                          </div>
                          <div>
                            <label className="block text-sm font-medium text-gray-300 mb-1">聯絡電話 *</label>
                            <input type="tel" name="phone" required value={formData.phone} onChange={handleInputChange}
                              className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold" placeholder="09xx-xxxxxx" />
                          </div>
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-300 mb-1">居住地址 (呈疏用) *</label>
                          <input type="text" name="address" required value={formData.address} onChange={handleInputChange}
                            className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold" placeholder="請填寫目前居住地址" />
                        </div>

                        {/* 生日 */}
                        <div className="bg-dao-green/5 p-6 rounded border border-dao-green/20">
                          <label className="block text-sm font-medium text-dao-gold mb-2">出生資料</label>
                          <div className="flex gap-4 mb-4">
                            <label className="flex items-center gap-2 cursor-pointer">
                              <input type="radio" name="calendarType" value="農曆" checked={formData.calendarType === '農曆'} onChange={handleInputChange} className="accent-dao-gold" />
                              <span className="text-gray-300">農曆</span>
                            </label>
                            <label className="flex items-center gap-2 cursor-pointer">
                              <input type="radio" name="calendarType" value="國曆" checked={formData.calendarType === '國曆'} onChange={handleInputChange} className="accent-dao-gold" />
                              <span className="text-gray-300">國曆 (西元)</span>
                            </label>
                          </div>
                          <div className="grid grid-cols-2 gap-4">
                            <div>
                                <label className="block text-xs text-gray-400 mb-1">出生日期</label>
                                <input type="date" name="birthDate" required value={formData.birthDate} onChange={handleInputChange}
                                  className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold" />
                            </div>
                            <div>
                                <label className="block text-xs text-gray-400 mb-1">出生時辰</label>
                                <select name="birthTime" value={formData.birthTime} onChange={handleInputChange}
                                  className="w-full bg-dao-black border border-dao-green rounded px-4 py-3 text-white focus:outline-none focus:border-dao-gold">
                                  <option value="吉時">吉時</option>
                                  <option value="子時">子時 (23-01)</option>
                                  <option value="丑時">丑時 (01-03)</option>
                                  <option value="寅時">寅時 (03-05)</option>
                                  <option value="卯時">卯時 (05-07)</option>
                                  <option value="辰時">辰時 (07-09)</option>
                                  <option value="巳時">巳時 (09-11)</option>
                                  <option value="午時">午時 (11-13)</option>
                                  <option value="未時">未時 (13-15)</option>
                                  <option value="申時">申時 (15-17)</option>
                                  <option value="酉時">酉時 (17-19)</option>
                                  <option value="戌時">戌時 (19-21)</option>
                                  <option value="亥時">亥時 (21-23)</option>
                                </select>
                            </div>
                          </div>
                        </div>

                        {/* 日期選擇 */}
                        <div className="bg-dao-green/5 p-6 rounded border border-dao-green/20">
                           <label className="block text-sm font-medium text-dao-gold mb-1">選擇法會日期 (可複選) *</label>
                           <p className="text-xs text-gray-500 mb-3">※ 為確保疏文撰寫與法器準備，各場次將於法會前 5 天截止報名。</p>
                           <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-60 overflow-y-auto custom-scrollbar pr-2">
                             {schedule.flatMap((item, idx) => {
                               const sessions = [];
                               // 僅保留 "初一"、"十五"
                               if (item.d1) sessions.push({ type: '初一', dateInfo: item.d1, month: item.month, key: `d1-${idx}` });
                               if (item.d15) sessions.push({ type: '十五', dateInfo: item.d15, month: item.month, key: `d15-${idx}` });
                               return sessions;
                             })
                             .filter(session => session.dateInfo.actual >= cutoffDateString)
                             .map(session => {
                               const isSelected = formData.selectedDates.includes(session.dateInfo.actual);
                               return (
                                 <label key={session.key} className={`flex items-center gap-3 p-3 rounded border cursor-pointer transition-all ${isSelected ? 'bg-dao-green/30 border-dao-gold' : 'bg-dao-black border-dao-green/30'}`}>
                                    <input type="checkbox" checked={isSelected} onChange={() => toggleDate(session.dateInfo.actual)} className="accent-dao-gold w-5 h-5" />
                                    <div>
                                        <span className={`block text-sm ${isSelected ? 'text-dao-gold font-bold' : 'text-gray-300'}`}>{session.month} {session.type}</span>
                                        <span className="text-xs text-gray-500">{session.dateInfo.actual}</span>
                                    </div>
                                 </label>
                               )
                             })}
                           </div>
                        </div>

                        {/* 匯款資訊區塊 */}
                        <div className="bg-gradient-to-b from-dao-dark to-black backdrop-blur-sm p-6 md:p-8 rounded-lg border border-dao-gold/30 space-y-4 shadow-lg relative overflow-hidden mt-6">
                          <div className="absolute right-[-10%] top-[-20%] w-48 h-48 bg-dao-gold/10 blur-[60px] rounded-full pointer-events-none"></div>
                          
                          <h3 className="text-xl font-bold text-dao-gold mb-4 flex items-center gap-2 relative z-10">
                            <Icons.Lotus size={24} className="text-dao-jade" /> 專屬匯款資訊
                          </h3>
                          
                          <div className="bg-black/40 rounded-lg p-5 border border-dao-green/30 space-y-3 font-mono text-lg relative z-10">
                            <div className="flex flex-col sm:flex-row sm:justify-between sm:items-center border-b border-gray-800 pb-3 gap-1">
                              <span className="text-gray-400 font-sans text-sm">銀行代號</span>
                              <span className="font-bold text-white">013 <span className="text-base font-sans text-gray-400">(國泰世華銀行)</span></span>
                            </div>
                            <div className="flex flex-col sm:flex-row sm:justify-between sm:items-center pt-2 gap-1">
                              <span className="text-gray-400 font-sans text-sm">匯款帳號</span>
                              <span className="font-black text-dao-gold text-2xl tracking-widest">059506013547</span>
                            </div>
                            <div className="flex flex-col sm:flex-row sm:justify-between sm:items-center pt-4 mt-2 border-t border-gray-800 gap-1">
                              <span className="text-gray-400 font-sans text-sm">本次應繳結緣金</span>
                              <span className="font-black text-dao-gold text-2xl">NT$ {totalPrice.toLocaleString()}</span>
                            </div>
                          </div>
                          
                          <div className="bg-dao-green/10 border border-dao-green/50 p-4 rounded-lg text-sm text-gray-300 flex items-start gap-3 relative z-10">
                            <p className="leading-relaxed">
                              匯款完成後，請務必至 <a href="https://line.me/ti/p/~@995zkady#~" target="_blank" rel="noopener noreferrer" className="text-dao-jade border-b border-dao-jade/50 hover:text-white font-bold transition-colors">LINE@ 官方帳號</a> 告知您的<strong className="text-white">「匯款帳號後五碼」</strong>與<strong className="text-white">「報名姓名」</strong>，以便盡速為您對帳並安排科儀。
                            </p>
                          </div>
                        </div>

                        {/* 送出按鈕 */}
                        <div className="pt-4">
                          <button type="submit" disabled={isSubmitting} className="w-full bg-gradient-to-r from-dao-green to-emerald-800 hover:from-emerald-700 hover:to-emerald-900 text-white font-bold text-xl py-4 rounded-sm shadow-lg transition-all transform hover:-translate-y-1 flex justify-center gap-2">
                            {isSubmitting ? '傳送中...' : `確認送出疏文 (NT$ ${totalPrice.toLocaleString()})`}
                          </button>
                          <p className="text-center text-xs text-gray-500 mt-4">
                            太乙救苦天尊 尋聲救苦 解冤釋結
                          </p>
                        </div>

                      </form>
                    </>
                  )}
                </div>
              </section>

              {/* Footer */}
              <footer className="bg-black py-8 text-center text-gray-500 text-sm border-t border-dao-green/20">
                <p className="serif-font text-lg text-dao-gold mb-2">降叁 © 2026 丙午年 解業除障祈福專案</p>
              </footer>

            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
